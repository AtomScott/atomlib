---

title: Competitive Programming Library

keywords: fastai
sidebar: home_sidebar

summary: "Things to be used by copy & paste. Also useful for other situtations as well!"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_cp.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prime-Number-Problems">Prime Number Problems<a class="anchor-link" href="#Prime-Number-Problems">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-for-primes">Check for primes<a class="anchor-link" href="#Check-for-primes">&#182;</a></h3><p>Find wether a number is prime or not</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="c1"># Corner cases </span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="kc">True</span>
  
    <span class="c1"># This is checked so that we can skip  </span>
    <span class="c1"># middle five numbers in below loop </span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">return</span> <span class="kc">False</span>
  
    <span class="n">i</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">)</span> <span class="p">:</span> 
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> 
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">6</span>
  
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> is_prime(10**9+7)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>944 µs ± 30.9 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sieve-of-Eratosthenes">Sieve of Eratosthenes<a class="anchor-link" href="#Sieve-of-Eratosthenes">&#182;</a></h3><p>Gives all prime numbers less than or equal to n.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sieve_of_eratosthenes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">prime</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span> <span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">prime</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
                <span class="n">prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="k">return</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">prime</span><span class="p">[</span><span class="n">p</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> sieve_of_eratosthenes(10**6)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>151 ms ± 6.59 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Legendre&#8217;s-formula">Legendre&#8217;s formula<a class="anchor-link" href="#Legendre&#8217;s-formula">&#182;</a></h3><p>Given an integer $n$ and a prime number $p$, find the largest $x$ such that $p^x$ divides $n!$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">largest_power</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span> 
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">n</span><span class="p">:</span> 
        <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">p</span> 
        <span class="n">x</span> <span class="o">+=</span> <span class="n">n</span> 
    <span class="k">return</span> <span class="n">x</span> 

<span class="o">%</span><span class="k">timeit</span> largest_power(10**18, 27)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1.34 µs ± 41.2 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Combinatrics">Combinatrics<a class="anchor-link" href="#Combinatrics">&#182;</a></h2><p>Resources:</p>
<ul>
<li><a href="https://phillipmfeldman.org/Python/combinatorics.html">Combinatorices, Dr. Phillip M. Feldman</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multinomial-Coefficient">Multinomial Coefficient<a class="anchor-link" href="#Multinomial-Coefficient">&#182;</a></h3><p>A multinomial coefficient is often written in the form</p>
$$\binom{n}{k_1,k_2,\ldots,k_m}$$<p>where $k_1+k_2+\cdots+k_m = n.$ Because of that last equation, the n is redundant. Binomial coefficients are technically multinomial coefficients as well, but instead of writing $\binom{n}{k_1,k_2}$ where $k1+k2=n$, we usually write either $\binom{n}{k_1}$ or $\binom{n}{k_2}$. These are all mean exactly the same thing:</p>
$$\binom{k_1+k_2}{k_1,k_2}=\binom{k_1+k_2}{k_1}=\binom{k_1+k_2}{k_2} = \frac{(k_1+k_2)!}{k_1!\,k_2!}.$$<p>A multinomial coefficient can arise in a counting problem as follows:</p>
<ul>
<li>You have <strong>$m$ containers</strong>, with sizes $k_1,k_2,…,k_m$ respectively.</li>
<li>You have $n=k_1+k_2+⋯+k_m$ distinguishable objects, which are just enough to fill every container when drawing from the n objects <strong>without replacement</strong>.</li>
<li>The order of the containers matters.</li>
<li>The order of the objects within each container does not matter.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="multinomial_coefficients" class="doc_header"><code>multinomial_coefficients</code><a href="https://github.com/atomscott/atomlib/tree/master/atomlib/cp.py#L6" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>multinomial_coefficients</code>(<strong><code>K</code></strong>)</p>
</blockquote>
<p>Returns the multinomial coefficients</p>
<ul>
<li><code>K</code> - A list of $k_1, k_2...$</li>
</ul>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="multinomial_combinations" class="doc_header"><code>multinomial_combinations</code><a href="https://github.com/atomscott/atomlib/tree/master/atomlib/cp.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>multinomial_combinations</code>(<strong><code>items</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Examples:</p>
<ul>
<li><strong>How many words can you make from the letters in <em>coffee</em>?</strong></li>
</ul>
<p>The word <em>coffee</em> contains the letters C×1, O×1, F×2, E×2. Therefore the permutations will be,</p>
$$\binom{6}{1, 1, 2, 2} = \frac{6!}{1!1!2!2!} = 180$$<ul>
<li><strong>How many ways to divide a class of 15 students into 3 groups, A, B and C?</strong></li>
</ul>
$$\binom{15}{3, 3, 3, 3, 3} = \frac{15!}{(3!)^5} = 168168000$$
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">multinomial_coefficients</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the multinomial coefficient</span>
<span class="sd">    K = [k1, k2, k3, k4...]</span>
<span class="sd">    src: https://stackoverflow.com/a/46378809/5034709</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="n">i0</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">K</span><span class="p">[:</span><span class="n">i0</span><span class="p">]</span> <span class="o">+</span> <span class="n">K</span><span class="p">[</span><span class="n">i0</span><span class="o">+</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">*=</span> <span class="n">i</span>
            <span class="n">res</span> <span class="o">//=</span> <span class="n">j</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>

<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MISSISSIPPI&#39;</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="s1">&#39;MISSISSIPPI&#39;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multinomial_coefficients</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>168168000
34650
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Very slow method of computing multinomial combinations using permutations and sets</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">permutations</span>

<span class="k">def</span> <span class="nf">multinomial_combinations_slow</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">permutations</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>

<span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="s1">&#39;MISSISSIPPI&#39;</span><span class="p">]</span>
<span class="k">with</span> <span class="n">timing</span><span class="p">():</span>
    <span class="n">combs</span> <span class="o">=</span> <span class="n">multinomial_combinations_slow</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">combs</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combs</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(&#39;S&#39;, &#39;S&#39;, &#39;S&#39;, &#39;P&#39;, &#39;I&#39;, &#39;I&#39;, &#39;P&#39;, &#39;M&#39;, &#39;S&#39;, &#39;I&#39;, &#39;I&#39;)
34650
Time: 3.9913318157196045
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below is a faster dynamic programming solution.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span><span class="p">,</span><span class="n">repeat</span><span class="p">,</span><span class="n">islice</span><span class="p">,</span><span class="n">count</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="k">def</span> <span class="nf">combinations_without_repetition</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">iterable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">counts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">iterable</span><span class="p">:</span>
        <span class="n">values</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">Counter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">c</span><span class="p">:</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">repeat</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">count</span><span class="p">(),</span><span class="n">counts</span><span class="p">),</span> <span class="n">r</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="n">f</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">counts</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">r</span><span class="p">),</span> <span class="n">f</span><span class="p">(</span><span class="n">count</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">islice</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="kc">None</span><span class="p">))):</span>
            <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>

<span class="k">with</span> <span class="n">timing</span><span class="p">():</span>
    <span class="n">combs</span> <span class="o">=</span> <span class="n">combinations_without_repetition</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span><span class="n">items</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">combs</span><span class="p">))</span>
<span class="c1">#     print(next(iter(combs)))</span>
<span class="c1">#     print(len(combs))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(&#39;M&#39;, &#39;I&#39;, &#39;I&#39;, &#39;I&#39;, &#39;I&#39;, &#39;S&#39;, &#39;S&#39;, &#39;S&#39;, &#39;S&#39;, &#39;P&#39;, &#39;P&#39;)]
Time: 0.0003483295440673828
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">c</span><span class="p">,)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c_first</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">items_remaining</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c_other</span> <span class="ow">in</span> <span class="n">m_way_ordered_combinations</span><span class="p">(</span><span class="n">items_remaining</span><span class="p">,</span> <span class="n">K</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">c_first</span><span class="p">,)</span> <span class="o">+</span> <span class="n">c_other</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span><span class="o">,</span> <span class="nn">itertools</span>

<span class="k">def</span> <span class="nf">multiset_combinations</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">max_power</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;returns a list (2d numpy array) of all length k sequences of </span>
<span class="sd">    non-negative integers n1, ..., nk such that n1 + ... + nk = n.&quot;&quot;&quot;</span>
    <span class="n">bar_placements</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">k</span><span class="p">,)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bar_placements</span><span class="p">]</span>
    <span class="n">sequences</span> <span class="o">=</span>  <span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">max_power</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sequences</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">sequences</span><span class="o">&lt;=</span><span class="n">max_power</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sequences</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">multinomial_combinations</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[5, 0, 0],
       [4, 1, 0],
       [4, 0, 1],
       [3, 2, 0],
       [3, 1, 1],
       [3, 0, 2],
       [2, 3, 0],
       [2, 2, 1],
       [2, 1, 2],
       [2, 0, 3],
       [1, 4, 0],
       [1, 3, 1],
       [1, 2, 2],
       [1, 1, 3],
       [1, 0, 4],
       [0, 5, 0],
       [0, 4, 1],
       [0, 3, 2],
       [0, 2, 3],
       [0, 1, 4],
       [0, 0, 5]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multiset-Coefficient">Multiset Coefficient<a class="anchor-link" href="#Multiset-Coefficient">&#182;</a></h2><p>A multiset coefficient is often written in the form</p>
$$\binom{n+k-1}{k}$$<p>A multiset coefficient can arise as follows:</p>
<ul>
<li>You have n distinguishable objects.</li>
<li>You have a <strong>single container</strong> able to hold k objects.</li>
<li>You draw objects from the n objects with replacement, and put the copies of those objects into the container.</li>
<li>You continue putting copies of objects in the container until it is full.</li>
<li>The order of objects in the container does not matter.</li>
</ul>
<p>A multiset coefficient can alternatively arise this way:</p>
<ul>
<li>You have k objects that are indistinguishable or that you choose not to distinguish.</li>
<li>You have n containers, each with effectively infinite capacity (they never get full).</li>
<li>You draw the objects without replacement and put them in the containers.</li>
<li>The order of the containers matters.</li>
<li>The order of objects in a container cannot matter, because by assumption you cannot tell which object is which, only how many are in each container.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

<h2 id="Memoization">Memoization<a class="anchor-link" href="#Memoization">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Factorial">Factorial<a class="anchor-link" href="#Factorial">&#182;</a></h3><p>Calculates all the factorials up to n, $O(n)$.</p>
<p>Max n is $10^4$. If theres a large prime look at the <code>factorial_mod()</code> solution.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">init_factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">facs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">facs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">facs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">facs</span>

<span class="n">facs</span> <span class="o">=</span> <span class="n">init_factorial</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

<h2 id="Modulo-10**9-+-7-Problems">Modulo 10**9 + 7 Problems<a class="anchor-link" href="#Modulo-10**9-+-7-Problems">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Binomial-Modulo">Binomial Modulo<a class="anchor-link" href="#Binomial-Modulo">&#182;</a></h3><p>Fast way to solve $nCr \ \ \% \ \ MOD $ when MOD is prime.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">binomial_mod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="p">(</span><span class="n">numerator</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>

    <span class="n">denominator</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="p">(</span><span class="n">denominator</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">numerator</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="n">denominator</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span> <span class="o">%</span> <span class="n">p</span>

<span class="n">MOD</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="o">+</span><span class="mi">7</span>
<span class="o">%</span><span class="k">timeit</span> binomial_mod(10**9, 10**6, MOD)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>285 ms ± 5.32 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Factorial-Modulo">Factorial Modulo<a class="anchor-link" href="#Factorial-Modulo">&#182;</a></h3><p>Fast way to solve $n!\ \ \% \ \ MOD$ when MOD is prime</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">factorial_mod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">ans</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">ans</span> <span class="o">*</span> <span class="n">i</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">ans</span>

<span class="n">MOD</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="o">+</span><span class="mi">7</span>
<span class="o">%</span><span class="k">timeit</span> factorial_mod(10**6, MOD)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>125 ms ± 3 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

